<div class="max-w-6xl mx-auto px-4">
  <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 items-start">
    <section class="lg:col-span-7 space-y-6">
      <div class="card bg-base-100 shadow-sm border border-base-200">
        <div class="card-body p-6 md:p-8">
          <app-form-header title="Dados do tutor" description="Identificação" [icon]="UserRound" />
          <form class="flex flex-col gap-5" [formGroup]="tutorForm" (ngSubmit)="onSave()">
            <app-upload 
              [currentPhotoUrl]="(tutorsFacade.tutor$ | async)?.foto?.url"
              [isUploading]="tutorsFacade.loading$ | async"
              (fileChange)="onFileChange($event)"
              (removeRequest)="onRemoveRequest()">
            </app-upload>
            <div class="grid grid-cols-1 gap-4">
              <app-input formControlName="nome" label="Nome Completo" placeholder="Ex: João da Silva" type="text" />
              <app-input formControlName="telefone" label="Telefone" mask="phone" placeholder="(00) 00000-0000" type="text" />
              <app-input formControlName="endereco" label="Endereço" placeholder="Rua, número, bairro..." type="text" />
            </div>
            <app-form-actions 
              [isEdit]="!!tutorId"
              [isInvalid]="tutorForm.invalid || (tutorsFacade.loading$ | async) || false"
              (back)="onBack()"
              (delete)="onDelete()"/>
          </form>
        </div>
      </div>
    </section>
  
    <app-tutor-pets-list 
      class="lg:col-span-5"
      [tutorId]="tutorId"
      [pets]="(tutorsFacade.tutor$ | async)?.pets || []"
      (addRequest)="openLinkModal()"
      (removeRequest)="onUnlinkPet($event)">
    </app-tutor-pets-list>
  </div>
</div>

<app-modal [isOpen]="isModalOpen" (close)="onModalClose()" customClass="max-w-md">
  <div title class="flex items-center gap-2">
    <lucide-angular [img]="SearchIcon" size="20"></lucide-angular>
    Vincular Pet
  </div>
  <app-tutor-pet-select
    [pets]="(petsFacade.petsList$ | async)?.content || []"
    [searchControl]="petSearchControl"
    (select)="onConfirmLink($event)">
  </app-tutor-pet-select>
  <div footer>
    <app-button variant="btn-neutral" (action)="onModalClose()">
      Cancelar
    </app-button>
  </div>
</app-modal>
